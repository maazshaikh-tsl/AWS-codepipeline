version: 0.2

phases:
  install:
    commands:
      - echo "Installing dependencies"
      - yum update -y
      - yum install -y git
      - echo "Authenticating with GitHub"
      - git config --global credential.helper 'store'
      - echo "https://$GITHUB_TOKEN:@github.com" > ~/.git-credentials

  build:
    commands:
      - echo "Cloning repository..."
      - git clone https://github.com/maazshaikh-tsl/AWS-codepipeline.git  # Update with your actual repo URL
      - cd AWS-codepipeline                  # Navigate to the cloned repo directory
      - echo "Current working directory:"
      - pwd                                   # Print current directory to ensure it's correct
      - echo "Listing files in the directory:"
      - ls -la                                # List all files, including hidden ones
      - echo "Checking for dist directory..."
      - mkdir -p dist                         # Ensure dist directory exists
      - echo "Ensuring proper permissions..."
      - chmod -R 755 .                        # Ensure files have readable permissions
      - echo "Copying files to dist directory..."
      - cp -r . dist/                         # Copy all files to dist/

artifacts:
  files:
    - dist/**                                 # Include all files in the dist directory
